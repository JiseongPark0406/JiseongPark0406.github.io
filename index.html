<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ“ ìŠ¤ë§ˆíŠ¸ ì‹œê°„í‘œ ë¹Œë”</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“ ìŠ¤ë§ˆíŠ¸ ì‹œê°„í‘œ ë¹Œë” v0.2.1</h1>
      <p>ì™„ë²½í•œ ì‹œê°„í‘œë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!</p>
    </div>

    <div class="main-content">
      <!-- ===== ì‚¬ì´ë“œë°” ===== -->
      <div class="sidebar">
        <!-- 1. ê³¼ëª©ëª… ê²€ìƒ‰ -->
        <div class="form-group">
          <label for="searchInput">ğŸ” ê³¼ëª©ëª… ê²€ìƒ‰</label>
          <input type="text" id="searchInput" class="form-control" placeholder="ê²€ìƒ‰í•  ê³¼ëª©ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" />
        </div>

        <!-- 2. ë¶„ë¥˜ ì„ íƒ (ì „ê³µ/êµì–‘/ê¸°ì´ˆêµì–‘) -->
        <div class="form-group">
          <label for="categorySelect">ğŸ“‚ ë¶„ë¥˜ ì„ íƒ</label>
          <select id="categorySelect" class="form-control">
            <option value="">ì „ì²´</option>
          </select>
        </div>

        <!-- 3. ì „ê³µ ì„ íƒ - ë¶„ë¥˜ì— ë”°ë¼ ì˜µì…˜ ì¬êµ¬ì„± -->
        <div class="form-group">
          <label for="majorSelect">ğŸ“š ì „ê³µ ì„ íƒ</label>
          <select id="majorSelect" class="form-control">
            <option value="">ì „ì²´</option>
          </select>
        </div>

        <!-- 4. ì„¸ë¶€ í•„í„°: ì´ìˆ˜êµ¬ë¶„ -->
        <div class="form-group">
          <label for="courseTypeSelect">ğŸ“– ì´ìˆ˜êµ¬ë¶„</label>
          <select id="courseTypeSelect" class="form-control">
            <option value="">ì „ì²´</option>
          </select>
        </div>

        <!-- 5. ì„¸ë¶€ í•„í„°: ìˆ˜ì—…ë°©ë²• -->
        <div class="form-group">
          <label for="methodSelect">ğŸ’» ìˆ˜ì—…ë°©ë²•</label>
          <select id="methodSelect" class="form-control">
            <option value="">ì „ì²´</option>
          </select>
        </div>

        <!-- 6. ê³¼ëª© ë¦¬ìŠ¤íŠ¸ -->
        <div class="form-group">
          <label>âœ… ê³¼ëª© ë¦¬ìŠ¤íŠ¸</label>
          <div id="courseList" class="course-list">
            <div class="loading-message">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
          </div>
        </div>

        <!-- ì„ íƒëœ ê³¼ëª© ëª©ë¡ -->
        <div class="selected-courses">
          <h4>ğŸ“‹ ì„ íƒëœ ê³¼ëª©</h4>
          <div id="selectedCourses"></div>
          <button id="clearAllBtn" class="clear-all-btn" style="display:none">ğŸ”„ ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
      </div>

      <!-- ===== ë³¸ë¬¸ ì˜ì—­ ===== -->
      <div class="content">
        <div class="credits-display">
          <h2 id="totalCredits">ì´ í•™ì : 0í•™ì </h2>
          <p id="courseCount">ì„ íƒëœ ê³¼ëª© ìˆ˜: 0ê°œ</p>
        </div>
        <!-- ì‹œê°„í‘œ ê·¸ë¦¬ë“œ ì˜ì—­ (ì¶”í›„ êµ¬í˜„) -->
      </div>
    </div>
  </div>

<script>
const DATA_URL = './course_dataset_expanded.csv';
let data = [];

// DOM Elements
const searchInput       = document.getElementById('searchInput');
const categorySelect    = document.getElementById('categorySelect');
const majorSelect       = document.getElementById('majorSelect');
const typeSelect        = document.getElementById('courseTypeSelect');
const methodSelect      = document.getElementById('methodSelect');
const courseList        = document.getElementById('courseList');

// CSV ë¡œë“œ í›„ ì´ˆê¸°í™”
fetch(DATA_URL).then(r=>r.text()).then(text=>{
  data = Papa.parse(text,{header:true,skipEmptyLines:true}).data;
  initFilters();
  renderCourses();
});

function unique(list){return [...new Set(list)];}

function initFilters(){
  // ë¶„ë¥˜ & ìˆ˜ì—…ë°©ë²• ê³ ìœ ê°’
  populate(categorySelect, unique(data.map(r=>r['ë¶„ë¥˜'])));
  populate(methodSelect,   unique(data.map(r=>r['ìˆ˜ì—…ë°©ë²•'])));
  updateMajorAndType();
}

function populate(sel, arr) {
        // ê³µë°± ì œê±° + ê°€ë‚˜ë‹¤ìˆœ ì •ë ¬
        arr = arr.filter(Boolean)
                 .sort((a, b) => a.localeCompare(b, "ko-KR"));
        sel.innerHTML =
          '<option value="">ì „ì²´</option>' +
          arr.map((v) => `<option value="${v}">${v}</option>`).join("");
      }">${v}</option>`).join('');
}

function updateMajorAndType(){
  const cat = categorySelect.value;
  const filtered = data.filter(r=>!cat || r['ë¶„ë¥˜']===cat);
  populate(majorSelect, unique(filtered.map(r=>r['ì „ê³µ'])));
  populate(typeSelect,  unique(filtered.map(r=>r['ì´ìˆ˜êµ¬ë¶„']||'')));
}

function renderCourses(){
  const kw   = searchInput.value.trim().toLowerCase();
  const cat  = categorySelect.value;
  const maj  = majorSelect.value;
  const ctype= typeSelect.value;
  const meth = methodSelect.value;

  const list = data.filter(r=>{
    if(kw   && !r['êµê³¼ëª©ëª…'].toLowerCase().includes(kw)) return false;
    if(cat  && r['ë¶„ë¥˜']!==cat) return false;
    if(maj  && r['ì „ê³µ']!==maj) return false;
    if(ctype&& r['ì´ìˆ˜êµ¬ë¶„']!==ctype) return false;
    if(meth && r['ìˆ˜ì—…ë°©ë²•']!==meth) return false;
    return true;
  });

  if(!list.length){courseList.innerHTML='<div class="course-item">ì¼ì¹˜í•˜ëŠ” ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤</div>';return;}

  courseList.innerHTML = list.map(r=>`<div class="course-item" title="${r['êµìˆ˜ëª…']} | ${r['ìš”ì¼']} ${r['êµì‹œ/ì‹œê°„']} | ${r['ìˆ˜ì—…ë°©ë²•']}">
      ${r['êµê³¼ëª©ëª…']} <span class="badge">${r['ì „ê³µ']}</span>
    </div>`).join('');
}

// ì´ë²¤íŠ¸ ë°”ì¸ë”©
searchInput.addEventListener('input', renderCourses);
categorySelect.addEventListener('change', ()=>{updateMajorAndType(); renderCourses();});
majorSelect.addEventListener('change', renderCourses);
typeSelect.addEventListener('change', renderCourses);
methodSelect.addEventListener('change', renderCourses);
</script>
</body>
</html>
